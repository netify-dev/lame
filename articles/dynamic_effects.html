<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Dynamic Effects in Longitudinal AME Models • lame</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Dynamic Effects in Longitudinal AME Models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/lame-overview.html">lame Overview</a></li>
    <li><a class="dropdown-item" href="../articles/dynamic_effects.html">Dynamic Effects in Longitudinal AME Models</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/netify-dev/lame" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Dynamic Effects in Longitudinal AME Models</h1>
                        <h4 data-toc-skip class="author">Cassy Dorff,
Tosin Salau, Shahryar Minhas</h4>
            
            <h4 data-toc-skip class="date">2025-08-11</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/netify-dev/lame/blob/main/vignettes/dynamic_effects.Rmd" class="external-link"><code>vignettes/dynamic_effects.Rmd</code></a></small>
      <div class="d-none name"><code>dynamic_effects.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>lame</code> package extends the Additive and Multiplicative
Effects (AME) model to longitudinal network data through the
introduction of dynamic effects. This vignette explains the theoretical
foundation, implementation details, and practical usage of the
<code>dynamic_uv</code> and <code>dynamic_ab</code> parameters.</p>
</div>
<div class="section level2">
<h2 id="theoretical-background">Theoretical Background<a class="anchor" aria-label="anchor" href="#theoretical-background"></a>
</h2>
<div class="section level3">
<h3 id="standard-ame-model">Standard AME Model<a class="anchor" aria-label="anchor" href="#standard-ame-model"></a>
</h3>
<p>The standard AME model decomposes network structure as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>=</mo><mi>β</mi><mi>′</mi><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><mo>+</mo><msub><mi>a</mi><mi>i</mi></msub><mo>+</mo><msub><mi>b</mi><mi>j</mi></msub><mo>+</mo><msub><mi>u</mi><mi>i</mi></msub><mi>′</mi><msub><mi>v</mi><mi>j</mi></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">y_{ij} = \beta'x_{ij} + a_i + b_j + u_i'v_j + \epsilon_{ij}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mi>′</mi><msub><mi>x</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\beta'x_{ij}</annotation></semantics></math>:
Fixed effects of covariates</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>a</mi><mi>i</mi></msub><annotation encoding="application/x-tex">a_i</annotation></semantics></math>:
Sender (row) effect for node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>b</mi><mi>j</mi></msub><annotation encoding="application/x-tex">b_j</annotation></semantics></math>:
Receiver (column) effect for node
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>j</mi><annotation encoding="application/x-tex">j</annotation></semantics></math>
</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>u</mi><mi>i</mi></msub><mi>′</mi><msub><mi>v</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">u_i'v_j</annotation></semantics></math>:
Multiplicative interaction between latent factors</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ϵ</mi><mrow><mi>i</mi><mi>j</mi></mrow></msub><annotation encoding="application/x-tex">\epsilon_{ij}</annotation></semantics></math>:
Dyadic error term</li>
</ul>
</div>
<div class="section level3">
<h3 id="dynamic-extensions">Dynamic Extensions<a class="anchor" aria-label="anchor" href="#dynamic-extensions"></a>
</h3>
<p>For longitudinal data with networks observed at times
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>.</mi><mi>.</mi><mi>.</mi><mo>,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">t = 1, ..., T</annotation></semantics></math>,
we extend the model to allow temporal evolution of effects.</p>
<div class="section level4">
<h4 id="dynamic-multiplicative-effects-dynamic_uv-true">Dynamic Multiplicative Effects (<code>dynamic_uv = TRUE</code>)<a class="anchor" aria-label="anchor" href="#dynamic-multiplicative-effects-dynamic_uv-true"></a>
</h4>
<p>The latent factors evolve according to AR(1) processes:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>U</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub><msub><mi>U</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">U_{i,k,t} = \rho_{uv} U_{i,k,t-1} + \epsilon_{i,k,t}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>V</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub><msub><mi>V</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>η</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">V_{j,k,t} = \rho_{uv} V_{j,k,t-1} + \eta_{j,k,t}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>η</mi><mrow><mi>j</mi><mo>,</mo><mi>k</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mrow><mi>u</mi><mi>v</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{i,k,t}, \eta_{j,k,t} \sim N(0, \sigma_{uv}^2)</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{uv} \in (0,1)</annotation></semantics></math>
controls temporal persistence</li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>,</mo><mi>j</mi></mrow><annotation encoding="application/x-tex">i,j</annotation></semantics></math>
index actors,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
indexes latent dimensions,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>t</mi><annotation encoding="application/x-tex">t</annotation></semantics></math>
indexes time</li>
</ul>
<p>This specification allows actors’ positions in latent social space to
drift over time, capturing:</p>
<ul>
<li>Evolving community structure</li>
<li>Time-varying homophily patterns</li>
<li>Dynamic clustering and transitivity</li>
</ul>
</div>
<div class="section level4">
<h4 id="dynamic-additive-effects-dynamic_ab-true">Dynamic Additive Effects (<code>dynamic_ab = TRUE</code>)<a class="anchor" aria-label="anchor" href="#dynamic-additive-effects-dynamic_ab-true"></a>
</h4>
<p>The sender and receiver effects evolve as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><msub><mi>a</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">a_{i,t} = \rho_{ab} a_{i,t-1} + \epsilon_{i,t}</annotation></semantics></math><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>b</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>=</mo><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><msub><mi>b</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>η</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">b_{j,t} = \rho_{ab} b_{j,t-1} + \eta_{j,t}</annotation></semantics></math></p>
<p>where:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ϵ</mi><mrow><mi>i</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>,</mo><msub><mi>η</mi><mrow><mi>j</mi><mo>,</mo><mi>t</mi></mrow></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msubsup><mi>σ</mi><mrow><mi>a</mi><mi>b</mi></mrow><mn>2</mn></msubsup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\epsilon_{i,t}, \eta_{j,t} \sim N(0, \sigma_{ab}^2)</annotation></semantics></math></li>
<li>
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{ab} \in (0,1)</annotation></semantics></math>
controls temporal smoothness</li>
</ul>
<p>This captures:</p>
<ul>
<li>Time-varying activity levels (outdegree heterogeneity)</li>
<li>Changing popularity (indegree heterogeneity)</li>
<li>Life-cycle effects in social networks</li>
</ul>
</div>
</div>
</div>
<div class="section level2">
<h2 id="prior-specifications">Prior Specifications<a class="anchor" aria-label="anchor" href="#prior-specifications"></a>
</h2>
<div class="section level3">
<h3 id="for-dynamic-parameters">For Dynamic Parameters<a class="anchor" aria-label="anchor" href="#for-dynamic-parameters"></a>
</h3>
<p>The package uses the following default priors:</p>
<p><strong>AR(1) coefficients:</strong></p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>u</mi><mi>v</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">TruncNormal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.9</mn><mo>,</mo><mn>0.1</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{uv} \sim \text{TruncNormal}(0.9, 0.1, 0, 1)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ρ</mi><mrow><mi>a</mi><mi>b</mi></mrow></msub><mo>∼</mo><mtext mathvariant="normal">TruncNormal</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0.8</mn><mo>,</mo><mn>0.15</mn><mo>,</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\rho_{ab} \sim \text{TruncNormal}(0.8, 0.15, 0, 1)</annotation></semantics></math></li>
</ul>
<p><strong>Innovation variances:</strong></p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>u</mi><mi>v</mi></mrow><mn>2</mn></msubsup><mo>∼</mo><mtext mathvariant="normal">InverseGamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma_{uv}^2 \sim \text{InverseGamma}(2, 1)</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mrow><mi>a</mi><mi>b</mi></mrow><mn>2</mn></msubsup><mo>∼</mo><mtext mathvariant="normal">InverseGamma</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>2</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\sigma_{ab}^2 \sim \text{InverseGamma}(2, 1)</annotation></semantics></math></li>
</ul>
<p>These can be customized via the <code>prior</code> argument:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">prior_custom</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  rho_uv_mean <span class="op">=</span> <span class="fl">0.95</span>,    <span class="co"># Higher persistence for UV</span></span>
<span>  rho_uv_sd <span class="op">=</span> <span class="fl">0.05</span>,      <span class="co"># Tighter prior</span></span>
<span>  sigma_uv_shape <span class="op">=</span> <span class="fl">3</span>,    <span class="co"># Different variance prior</span></span>
<span>  sigma_uv_scale <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="implementation-details">Implementation Details<a class="anchor" aria-label="anchor" href="#implementation-details"></a>
</h2>
<div class="section level3">
<h3 id="computational-efficiency">Computational Efficiency<a class="anchor" aria-label="anchor" href="#computational-efficiency"></a>
</h3>
<p>The dynamic effects are implemented in C++ via <code>Rcpp</code> and
<code>RcppArmadillo</code>:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Block sampling</strong>: Updates are performed in blocks to
improve mixing</li>
<li>
<strong>Sparse operations</strong>: Exploits temporal structure for
efficiency</li>
<li>
<strong>Memory optimization</strong>: about a 50% reduction compared
to R implementation</li>
</ol>
</div>
<div class="section level3">
<h3 id="algorithmic-details">Algorithmic Details<a class="anchor" aria-label="anchor" href="#algorithmic-details"></a>
</h3>
<p>The MCMC sampler alternates between:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Forward filtering</strong>: Compute predictive distributions
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mrow><mn>1</mn><mo>:</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x_t | x_{1:t-1})</annotation></semantics></math>
</li>
<li>
<strong>Backward sampling</strong>: Sample from smoothed
distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>y</mi><mrow><mn>1</mn><mo>:</mo><mi>T</mi></mrow></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(x_{1:T} | y_{1:T})</annotation></semantics></math>
</li>
<li>
<strong>Parameter updates</strong>: Sample
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
given state sequences</li>
</ol>
<p>This forward-filtering backward-sampling (FFBS) approach explores the
posterior distribution.</p>
</div>
</div>
<div class="section level2">
<h2 id="practical-usage">Practical Usage<a class="anchor" aria-label="anchor" href="#practical-usage"></a>
</h2>
<div class="section level3">
<h3 id="basic-example">Basic Example<a class="anchor" aria-label="anchor" href="#basic-example"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://netify-dev.github.io/lame/">lame</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate longitudinal network data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">50</span>  <span class="co"># actors</span></span>
<span><span class="cn">T</span> <span class="op">&lt;-</span> <span class="fl">10</span>  <span class="co"># time periods</span></span>
<span></span>
<span><span class="co"># Generate networks (example with binary data)</span></span>
<span><span class="va">Y_list</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">t</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="cn">T</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">Y_t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span><span class="op">*</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.1</span><span class="op">)</span>, <span class="va">n</span>, <span class="va">n</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">Y_t</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span>
<span>  <span class="va">Y_list</span><span class="op">[[</span><span class="va">t</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">Y_t</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Fit model with dynamic effects</span></span>
<span><span class="va">fit_dynamic</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lame.html">lame</a></span><span class="op">(</span></span>
<span>  Y <span class="op">=</span> <span class="va">Y_list</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">2</span>,                <span class="co"># 2-dimensional latent space</span></span>
<span>  dynamic_uv <span class="op">=</span> <span class="cn">TRUE</span>,    <span class="co"># Dynamic latent factors</span></span>
<span>  dynamic_ab <span class="op">=</span> <span class="cn">TRUE</span>,    <span class="co"># Dynamic additive effects</span></span>
<span>  family <span class="op">=</span> <span class="st">"binary"</span>,</span>
<span>  burn <span class="op">=</span> <span class="fl">1000</span>,         <span class="co"># Longer burn-in recommended</span></span>
<span>  nscan <span class="op">=</span> <span class="fl">5000</span>,</span>
<span>  odens <span class="op">=</span> <span class="fl">25</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="visualization">Visualization<a class="anchor" aria-label="anchor" href="#visualization"></a>
</h3>
<p>Plotting functions can illustrate temporal dynamics:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Plot latent positions at specific time</span></span>
<span><span class="fu"><a href="../reference/uv_plot.html">uv_plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span>, time_point <span class="op">=</span> <span class="fl">5</span>, plot_type <span class="op">=</span> <span class="st">"snapshot"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot trajectory of latent positions</span></span>
<span><span class="fu"><a href="../reference/uv_plot.html">uv_plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span>, plot_type <span class="op">=</span> <span class="st">"trajectory"</span>, show_actors <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot additive effects evolution</span></span>
<span><span class="fu"><a href="../reference/ab_plot.html">ab_plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span>, effect <span class="op">=</span> <span class="st">"sender"</span>, plot_type <span class="op">=</span> <span class="st">"trajectory"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="model-selection">Model Selection<a class="anchor" aria-label="anchor" href="#model-selection"></a>
</h3>
<p>Choose between static and dynamic specifications based on:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Model fit statistics</strong>: Compare GOF, AIC, BIC</li>
<li>
<strong>Parameter estimates</strong>: Check if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
significantly differs from 0</li>
<li>
<strong>Visual inspection</strong>: Look for temporal patterns in
residuals</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Static model</span></span>
<span><span class="va">fit_static</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lame.html">lame</a></span><span class="op">(</span><span class="va">Y_list</span>, R <span class="op">=</span> <span class="fl">2</span>, family <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dynamic UV only</span></span>
<span><span class="va">fit_uv</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lame.html">lame</a></span><span class="op">(</span><span class="va">Y_list</span>, R <span class="op">=</span> <span class="fl">2</span>, dynamic_uv <span class="op">=</span> <span class="cn">TRUE</span>, family <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Dynamic AB only  </span></span>
<span><span class="va">fit_ab</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lame.html">lame</a></span><span class="op">(</span><span class="va">Y_list</span>, R <span class="op">=</span> <span class="fl">2</span>, dynamic_ab <span class="op">=</span> <span class="cn">TRUE</span>, family <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Full dynamic</span></span>
<span><span class="va">fit_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/lame.html">lame</a></span><span class="op">(</span><span class="va">Y_list</span>, R <span class="op">=</span> <span class="fl">2</span>, dynamic_uv <span class="op">=</span> <span class="cn">TRUE</span>, dynamic_ab <span class="op">=</span> <span class="cn">TRUE</span>, family <span class="op">=</span> <span class="st">"binary"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare models</span></span>
<span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Static"</span>, <span class="st">"Dynamic UV"</span>, <span class="st">"Dynamic AB"</span>, <span class="st">"Full Dynamic"</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_static</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_uv</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_ab</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_full</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>,</span>
<span>  BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_static</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_uv</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_ab</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_full</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="convergence-diagnostics">Convergence Diagnostics<a class="anchor" aria-label="anchor" href="#convergence-diagnostics"></a>
</h2>
<p>Dynamic models typically require:</p>
<ul>
<li>Longer burn-in (≥ 1000 iterations)</li>
<li>More samples (≥ 20000 post burn-in)</li>
<li>Careful monitoring of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>ρ</mi><annotation encoding="application/x-tex">\rho</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>σ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>
parameters</li>
</ul>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check effective sample sizes</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">coda</span><span class="op">)</span></span>
<span><span class="va">mcmc_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/coda/man/mcmc.html" class="external-link">as.mcmc</a></span><span class="op">(</span><span class="va">fit_dynamic</span><span class="op">$</span><span class="va">BETA</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/coda/man/effectiveSize.html" class="external-link">effectiveSize</a></span><span class="op">(</span><span class="va">mcmc_samples</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Trace plots for dynamic parameters</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span><span class="op">$</span><span class="va">rho_uv_samples</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"rho_uv trace"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span><span class="op">$</span><span class="va">sigma_uv_samples</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"sigma_uv trace"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span><span class="op">$</span><span class="va">rho_ab_samples</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"rho_ab trace"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_dynamic</span><span class="op">$</span><span class="va">sigma_ab_samples</span>, type <span class="op">=</span> <span class="st">"l"</span>, main <span class="op">=</span> <span class="st">"sigma_ab trace"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<ol style="list-style-type: decimal">
<li><p><strong>Sewell, D. K., &amp; Chen, Y. (2015)</strong>. Latent
space models for dynamic networks. <em>Journal of the American
Statistical Association</em>, 110(512), 1646-1657.</p></li>
<li><p><strong>Durante, D., &amp; Dunson, D. B. (2014)</strong>.
Nonparametric Bayes dynamic modeling of relational data.
<em>Biometrika</em>, 101(4), 883-898.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="appendix-mathematical-details">Appendix: Mathematical Details<a class="anchor" aria-label="anchor" href="#appendix-mathematical-details"></a>
</h2>
<div class="section level3">
<h3 id="posterior-distributions">Posterior Distributions<a class="anchor" aria-label="anchor" href="#posterior-distributions"></a>
</h3>
<p>For the AR(1) parameters, the full conditionals are:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ρ</mi><mo stretchy="false" form="prefix">|</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>∝</mo><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>ρ</mi><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∏</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>x</mi><mi>t</mi></msub><mo stretchy="false" form="prefix">|</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>,</mo><mi>ρ</mi><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\rho | \cdot) \propto p(\rho) \prod_{t=2}^T p(x_t | x_{t-1}, \rho, \sigma^2)</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>p</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>σ</mi><mn>2</mn></msup><mo stretchy="false" form="prefix">|</mo><mo>⋅</mo><mo stretchy="true" form="postfix">)</mo></mrow><mo>∼</mo><mtext mathvariant="normal">IG</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>+</mo><mfrac><mrow><mi>n</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mn>2</mn></mfrac><mo>,</mo><mi>β</mi><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><munderover><mo>∑</mo><mrow><mi>t</mi><mo>=</mo><mn>2</mn></mrow><mi>T</mi></munderover><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><msub><mi>x</mi><mi>t</mi></msub><mo>−</mo><mi>ρ</mi><msub><mi>x</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><msup><mrow><mo stretchy="true" form="prefix">|</mo><mo stretchy="true" form="postfix">|</mo></mrow><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">p(\sigma^2 | \cdot) \sim \text{IG}\left(\alpha + \frac{n(T-1)}{2}, \beta + \frac{1}{2}\sum_{t=2}^T ||x_t - \rho x_{t-1}||^2\right)</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="identification">Identification<a class="anchor" aria-label="anchor" href="#identification"></a>
</h3>
<p>The dynamic effects are identified through: 1. Temporal ordering
constraints 2. Stationarity assumption
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">|</mo><mi>ρ</mi><mo stretchy="true" form="postfix">|</mo></mrow><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">|\rho| &lt; 1</annotation></semantics></math>)
3. Initial state distribution
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>1</mn></msub><mo>∼</mo><mi>N</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><msup><mi>σ</mi><mn>2</mn></msup><mi>/</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>ρ</mi><mn>2</mn></msup><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">x_1 \sim N(0, \sigma^2/(1-\rho^2))</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="computational-complexity">Computational Complexity<a class="anchor" aria-label="anchor" href="#computational-complexity"></a>
</h3>
<ul>
<li>
<strong>Time complexity</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><msup><mi>n</mi><mn>2</mn></msup><mi>R</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(n^2 RT)</annotation></semantics></math>
per iteration</li>
<li>
<strong>Space complexity</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mi>R</mi><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(nRT)</annotation></semantics></math>
for storage</li>
<li>
<strong>Mixing time</strong>: Typically
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>O</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo>log</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">O(\log T)</annotation></semantics></math>
with good initialization</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shahryar Minhas, Tosin Salau, Cassy Dorff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
