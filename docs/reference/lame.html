<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>AME model fitting routine for replicated relational data — lame • lame</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="AME model fitting routine for replicated relational data — lame"><meta property="og:description" content="An MCMC routine providing a fit to an additive and multiplicative effects
(AME) regression model to replicated relational data of
various types."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lame</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/lame-overview.html">lame Overview</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/netify-dev/lame/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>AME model fitting routine for replicated relational data</h1>
    <small class="dont-index">Source: <a href="https://github.com/netify-dev/lame/blob/HEAD/R/lame.R" class="external-link"><code>R/lame.R</code></a></small>
    <div class="hidden name"><code>lame.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>An MCMC routine providing a fit to an additive and multiplicative effects
(AME) regression model to replicated relational data of
various types.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lame</span><span class="op">(</span><span class="va">Y</span>,Xdyad<span class="op">=</span><span class="cn">NULL</span>, Xrow<span class="op">=</span><span class="cn">NULL</span>, Xcol<span class="op">=</span><span class="cn">NULL</span>, rvar <span class="op">=</span> <span class="op">!</span><span class="op">(</span><span class="va">family</span><span class="op">==</span><span class="st">"rrl"</span><span class="op">)</span></span>
<span>, cvar <span class="op">=</span> <span class="cn">TRUE</span>, dcor <span class="op">=</span> <span class="op">!</span><span class="va">symmetric</span>, nvar<span class="op">=</span><span class="cn">TRUE</span>,  R <span class="op">=</span> <span class="fl">0</span>, family <span class="op">=</span><span class="st">"nrm"</span>,</span>
<span>intercept<span class="op">=</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">is.element</a></span><span class="op">(</span><span class="va">family</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rrl"</span>,<span class="st">"ord"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>symmetric<span class="op">=</span><span class="cn">FALSE</span>,</span>
<span>odmax<span class="op">=</span><span class="cn">NULL</span>, prior<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, g<span class="op">=</span><span class="cn">NA</span>,</span>
<span>seed <span class="op">=</span> <span class="fl">6886</span>, nscan <span class="op">=</span> <span class="fl">10000</span>, burn <span class="op">=</span> <span class="fl">500</span>, odens <span class="op">=</span> <span class="fl">25</span>, plot<span class="op">=</span><span class="cn">FALSE</span>, print <span class="op">=</span> <span class="cn">FALSE</span>, gof<span class="op">=</span><span class="cn">TRUE</span>,</span>
<span>startVals<span class="op">=</span><span class="cn">NULL</span>, periodicSave<span class="op">=</span><span class="cn">FALSE</span>, outFile<span class="op">=</span><span class="cn">NULL</span>, saveInterval<span class="op">=</span><span class="fl">0.25</span>, model.name<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-y">Y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>a T length list of n x n relational matrices, where T
corresponds to the number of replicates (over time, for example).
See family below for various data types.</p></dd>


<dt id="arg-xdyad">Xdyad<a class="anchor" aria-label="anchor" href="#arg-xdyad"></a></dt>
<dd><p>a T length list of n x n x pd arrays of covariates</p></dd>


<dt id="arg-xrow">Xrow<a class="anchor" aria-label="anchor" href="#arg-xrow"></a></dt>
<dd><p>a T length list of n x pr matrices of nodal row covariates</p></dd>


<dt id="arg-xcol">Xcol<a class="anchor" aria-label="anchor" href="#arg-xcol"></a></dt>
<dd><p>a T length list of n x pc matrices of nodal column covariates</p></dd>


<dt id="arg-rvar">rvar<a class="anchor" aria-label="anchor" href="#arg-rvar"></a></dt>
<dd><p>logical: fit row random effects (asymmetric case)?</p></dd>


<dt id="arg-cvar">cvar<a class="anchor" aria-label="anchor" href="#arg-cvar"></a></dt>
<dd><p>logical: fit column random effects (asymmetric case)?</p></dd>


<dt id="arg-dcor">dcor<a class="anchor" aria-label="anchor" href="#arg-dcor"></a></dt>
<dd><p>logical: fit a dyadic correlation (asymmetric case)?</p></dd>


<dt id="arg-nvar">nvar<a class="anchor" aria-label="anchor" href="#arg-nvar"></a></dt>
<dd><p>logical: fit nodal random effects (symmetric case)?</p></dd>


<dt id="arg-r">R<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>integer: dimension of the multiplicative effects (can be zero)</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>character: one of "nrm","tob","bin","ord","cbin","frn","rrl" - see
the details below</p></dd>


<dt id="arg-intercept">intercept<a class="anchor" aria-label="anchor" href="#arg-intercept"></a></dt>
<dd><p>logical: fit model with an intercept?</p></dd>


<dt id="arg-symmetric">symmetric<a class="anchor" aria-label="anchor" href="#arg-symmetric"></a></dt>
<dd><p>logical: Is the sociomatrix symmetric by design?</p></dd>


<dt id="arg-odmax">odmax<a class="anchor" aria-label="anchor" href="#arg-odmax"></a></dt>
<dd><p>a scalar integer or vector of length n giving the maximum
number of nominations that each node may make - used for "frn" and "cbin"
families</p></dd>


<dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>a list containing hyperparameters for the prior distributions</p></dd>


<dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>optional scalar or vector for g-prior</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>random seed</p></dd>


<dt id="arg-nscan">nscan<a class="anchor" aria-label="anchor" href="#arg-nscan"></a></dt>
<dd><p>number of iterations of the Markov chain (beyond burn-in)</p></dd>


<dt id="arg-burn">burn<a class="anchor" aria-label="anchor" href="#arg-burn"></a></dt>
<dd><p>burn in for the Markov chain</p></dd>


<dt id="arg-odens">odens<a class="anchor" aria-label="anchor" href="#arg-odens"></a></dt>
<dd><p>output density for the Markov chain</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>logical: plot results while running?</p></dd>


<dt id="arg-print">print<a class="anchor" aria-label="anchor" href="#arg-print"></a></dt>
<dd><p>logical: print results while running?</p></dd>


<dt id="arg-gof">gof<a class="anchor" aria-label="anchor" href="#arg-gof"></a></dt>
<dd><p>logical: calculate goodness of fit statistics?</p></dd>


<dt id="arg-startvals">startVals<a class="anchor" aria-label="anchor" href="#arg-startvals"></a></dt>
<dd><p>List from previous model run containing parameter starting values for new MCMC</p></dd>


<dt id="arg-periodicsave">periodicSave<a class="anchor" aria-label="anchor" href="#arg-periodicsave"></a></dt>
<dd><p>logical: indicating whether to periodically save MCMC results</p></dd>


<dt id="arg-outfile">outFile<a class="anchor" aria-label="anchor" href="#arg-outfile"></a></dt>
<dd><p>character vector indicating name and path in which file should be stored if periodicSave is selected. For example, on an Apple OS outFile="~/Desktop/ameFit.rda".</p></dd>


<dt id="arg-saveinterval">saveInterval<a class="anchor" aria-label="anchor" href="#arg-saveinterval"></a></dt>
<dd><p>quantile interval indicating when to save during post burn-in phase.</p></dd>


<dt id="arg-model-name">model.name<a class="anchor" aria-label="anchor" href="#arg-model-name"></a></dt>
<dd><p>optional string for model selection output</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>


<dl><dt>BETA</dt>
<dd><p>posterior samples of regression coefficients</p></dd>

<dt>VC</dt>
<dd><p>posterior samples of the variance parameters</p></dd>

<dt>APM</dt>
<dd><p>posterior mean of additive row effects a</p></dd>
 <dt>BPM</dt>
<dd><p>posterior
mean of additive column effects b</p></dd>
 <dt>U</dt>
<dd><p>posterior mean of multiplicative
row effects u</p></dd>

<dt>V</dt>
<dd><p>posterior mean of multiplicative column effects v (asymmetric case)</p></dd>

<dt>UVPM</dt>
<dd><p>posterior mean of UV</p></dd>

<dt>ULUPM</dt>
<dd><p>posterior mean of ULU (symmetric case)</p></dd>

<dt>L</dt>
<dd><p>posterior mean of L (symmetric case)</p></dd>

<dt>EZ</dt>
<dd><p>estimate of expectation of Z
matrix</p></dd>
 <dt>YPM</dt>
<dd><p>posterior mean of Y (for imputing missing values)</p></dd>

<dt>GOF</dt>
<dd><p>observed (first row) and posterior predictive (remaining rows)
values of four goodness-of-fit statistics</p></dd>

<dt>startVals</dt>
<dd><p>Final parameter values from MCMC, can be used as the input
for a future model run.</p></dd>

<dt>AIC</dt>
<dd><p>Akaike Information Criterion (if model.name provided)</p></dd>

<dt>BIC</dt>
<dd><p>Bayesian Information Criterion (if model.name provided)</p></dd>

<dt>model.name</dt>
<dd><p>Name of the model (if provided)</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This command provides posterior inference for parameters in AME models of
independent replicated relational data, assuming one of seven possible data
types/models:</p>
<p>"nrm": A normal AME model.</p>
<p>"tob": A tobit AME model for censored continuous data. Values are censored
at zero, appropriate for non-negative continuous relational data.</p>
<p>"bin": A binary probit AME model.</p>
<p>"ord": An ordinal probit AME model. An intercept is not identifiable in this
model.</p>
<p>"cbin": An AME model for censored binary data.  The value of 'odmax'
specifies the maximum number of links each row may have.</p>
<p>"frn": An AME model for fixed rank nomination networks. A higher value of
the rank indicates a stronger relationship. The value of 'odmax' specifies
the maximum number of links each row may have.</p>
<p>"rrl": An AME model based on the row ranks. This is appropriate if the
relationships across rows are not directly comparable in terms of scale. An
intercept, row random effects and row regression effects are not estimable
for this model.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Peter Hoff, Yanjun He, Shahryar Minhas</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">YX_bin_list</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">fit</span><span class="op">&lt;-</span><span class="fu">lame</span><span class="op">(</span><span class="va">YX_bin_list</span><span class="op">$</span><span class="va">Y</span>,<span class="va">YX_bin_list</span><span class="op">$</span><span class="va">X</span>,burn<span class="op">=</span><span class="fl">5</span>,nscan<span class="op">=</span><span class="fl">5</span>,odens<span class="op">=</span><span class="fl">1</span>,family<span class="op">=</span><span class="st">"bin"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Starting burn-in period...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Burn-in period complete...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   |                                                                              |                                                                      |   0%  |                                                                              |==================                                                    |  25%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================================                  |  75%  |                                                                              |======================================================================| 100%</span>
<span class="r-in"><span><span class="co"># you should run the Markov chain much longer than this</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Shahryar Minhas, Tosin Salau, Cassy Dorff.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

      </footer></div>






  </body></html>

