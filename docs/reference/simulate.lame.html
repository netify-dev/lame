<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate longitudinal networks from a fitted LAME model — simulate.lame • lame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate longitudinal networks from a fitted LAME model — simulate.lame"><meta name="description" content="Generates multiple longitudinal network realizations from the posterior
distribution of a fitted LAME (Longitudinal AME) model. This function performs
posterior predictive simulation for dynamic networks, propagating both
cross-sectional and temporal uncertainty through the simulated trajectories."><meta property="og:description" content="Generates multiple longitudinal network realizations from the posterior
distribution of a fitted LAME (Longitudinal AME) model. This function performs
posterior predictive simulation for dynamic networks, propagating both
cross-sectional and temporal uncertainty through the simulated trajectories."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/netify-dev/lame" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate longitudinal networks from a fitted LAME model</h1>
      <small class="dont-index">Source: <a href="https://github.com/netify-dev/lame/blob/HEAD/R/simulate.lame.R" class="external-link"><code>R/simulate.lame.R</code></a></small>
      <div class="d-none name"><code>simulate.lame.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates multiple longitudinal network realizations from the posterior
distribution of a fitted LAME (Longitudinal AME) model. This function performs
posterior predictive simulation for dynamic networks, propagating both
cross-sectional and temporal uncertainty through the simulated trajectories.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'lame'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  return_latent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  start_from <span class="op">=</span> <span class="st">"posterior"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>fitted model object of class "lame"</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>number of network trajectories to simulate (default: 100)</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>random seed for reproducibility</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>optional list containing new covariate data:</p><dl><dt>Xdyad</dt>
<dd><p>list of T dyadic covariate arrays (n x n x p or nA x nB x p)</p></dd>

<dt>Xrow</dt>
<dd><p>list of T row/sender covariate matrices (n x p or nA x p)</p></dd>

<dt>Xcol</dt>
<dd><p>list of T column/receiver covariate matrices (n x p or nB x p)</p></dd>


</dl><p>If NULL, uses covariates from original model fit</p></dd>


<dt id="arg-n-time">n_time<a class="anchor" aria-label="anchor" href="#arg-n-time"></a></dt>
<dd><p>number of time periods to simulate. If NULL, uses same as original data</p></dd>


<dt id="arg-burn-in">burn_in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>number of initial MCMC samples to discard (default: 0)</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>thinning interval for MCMC samples (default: 1, use every sample)</p></dd>


<dt id="arg-return-latent">return_latent<a class="anchor" aria-label="anchor" href="#arg-return-latent"></a></dt>
<dd><p>logical: return latent Z matrices in addition to Y? (default: FALSE)</p></dd>


<dt id="arg-start-from">start_from<a class="anchor" aria-label="anchor" href="#arg-start-from"></a></dt>
<dd><p>character: how to initialize the simulation</p><dl><dt>"posterior"</dt>
<dd><p>start from posterior mean (default)</p></dd>

<dt>"random"</dt>
<dd><p>random initialization</p></dd>

<dt>"data"</dt>
<dd><p>use first time point from original data</p></dd>


</dl></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments (not currently used)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p><dl><dt>Y</dt>
<dd><p>list of nsim simulated longitudinal network trajectories,
each element is a list of T networks</p></dd>

<dt>Z</dt>
<dd><p>if return_latent=TRUE, list of nsim latent Z trajectories</p></dd>

<dt>family</dt>
<dd><p>the family of the model (binary, normal, etc.)</p></dd>

<dt>mode</dt>
<dd><p>network mode (unipartite or bipartite)</p></dd>

<dt>n_time</dt>
<dd><p>number of time periods</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Mathematical Framework for Longitudinal Networks:</strong></p>
<p>The LAME model extends AME to multiple time periods T with potential
temporal dependencies. For each time t = 1, ..., T:
$$Y_{ij,t} \sim F(Z_{ij,t})$$
where the latent network evolves as:
$$Z_{ij,t} = \beta^T x_{ij,t} + a_{i,t} + b_{j,t} + u_{i,t}^T v_{j,t} + \epsilon_{ij,t}$$</p>
<p><strong>Temporal Dynamics:</strong></p>
<p>LAME can incorporate three types of temporal dependencies:</p><ol><li><p><strong>Static Effects:</strong> Parameters constant over time</p><ul><li><p>\(a_{i,t} = a_i\), \(b_{j,t} = b_j\) for all t</p></li>
<li><p>\(u_{i,t} = u_i\), \(v_{j,t} = v_j\) for all t</p></li>
</ul></li>
<li><p><strong>Dynamic Additive Effects:</strong> AR(1) process for random effects
$$a_{i,t} = \rho_{ab} a_{i,t-1} + \eta_{i,t}, \quad \eta_{i,t} \sim N(0, \sigma_a^2(1-\rho_{ab}^2))$$
$$b_{j,t} = \rho_{ab} b_{j,t-1} + \xi_{j,t}, \quad \xi_{j,t} \sim N(0, \sigma_b^2(1-\rho_{ab}^2))$$
where \(\rho_{ab}\) is the temporal correlation parameter</p></li>
<li><p><strong>Dynamic Multiplicative Effects:</strong> AR(1) for latent factors
$$u_{i,t} = \rho_{uv} u_{i,t-1} + \omega_{i,t}$$
$$v_{j,t} = \rho_{uv} v_{j,t-1} + \psi_{j,t}$$</p></li>
</ol><p><strong>Uncertainty Quantification Process for Trajectories:</strong></p>
<p>For each simulated trajectory k = 1, ..., nsim:</p>
<p><strong>Step 1: Parameter Sampling</strong></p><ul><li><p>Draw MCMC iteration s uniformly from stored posterior samples</p></li>
<li><p>Extract static parameters: \(\beta^{(s)}\), variance components</p></li>
<li><p>Extract temporal parameters if applicable: \(\rho_{ab}^{(s)}\), \(\rho_{uv}^{(s)}\)</p></li>
</ul><p><strong>Step 2: Initialize at t = 1</strong></p>
<p>Depending on start_from parameter:</p><ul><li><p>"posterior": Use posterior means as starting values</p></li>
<li><p>"random": Draw from stationary distribution</p></li>
<li><p>For additive effects: \(a_{i,1}^{(k)} \sim N(0, \sigma_a^2)\)</p></li>
<li><p>For multiplicative effects: Initialize from prior</p></li>
</ul><p><strong>Step 3: Evolve Through Time</strong></p>
<p>For each t = 2, ..., T:</p>
<p>a) <strong>Update Dynamic Effects</strong> (if applicable):
$$a_{i,t}^{(k)} = \rho_{ab}^{(s)} a_{i,t-1}^{(k)} + \eta_{i,t}^{(k)}$$
where \(\eta_{i,t}^{(k)} \sim N(0, \sigma_a^2(1-[\rho_{ab}^{(s)}]^2))\)</p>
<p>The innovation variance \(\sigma_a^2(1-\rho_{ab}^2)\) ensures stationarity</p>
<p>b) <strong>Construct Latent Network</strong>:
$$E[Z_{ij,t}^{(k)}] = \beta^{(s)T} x_{ij,t} + a_{i,t}^{(k)} + b_{j,t}^{(k)} + u_{i,t}^T v_{j,t}$$</p>
<p>c) <strong>Add Dyadic Noise</strong>:
$$Z_{ij,t}^{(k)} = E[Z_{ij,t}^{(k)}] + \epsilon_{ij,t}^{(k)}$$
with correlation structure preserved from AME model</p>
<p>d) <strong>Generate Observations</strong>:
Apply appropriate link function based on family</p>
<p><strong>Sources of Uncertainty in Longitudinal Context:</strong></p><ol><li><p><strong>Cross-sectional uncertainty</strong> (as in AME):</p><ul><li><p>Parameter uncertainty from MCMC</p></li>
<li><p>Random effect variability</p></li>
<li><p>Dyadic noise</p></li>
</ul></li>
<li><p><strong>Temporal uncertainty</strong>:</p><ul><li><p>Uncertainty in temporal correlation parameters \(\rho_{ab}, \rho_{uv}\)</p></li>
<li><p>Innovation noise in AR(1) processes</p></li>
<li><p>Propagation of uncertainty through time (compounds over periods)</p></li>
</ul></li>
<li><p><strong>Initial condition uncertainty</strong>:</p><ul><li><p>Different starting values lead to different trajectories</p></li>
<li><p>Captured through start_from options</p></li>
</ul></li>
</ol><p><strong>Interpretation of Multiple Trajectories:</strong></p>
<p>Each simulated trajectory represents one possible evolution of the network
consistent with the posterior distribution. Variation across trajectories
captures:</p><ul><li><p>Model parameter uncertainty</p></li>
<li><p>Stochastic variation in temporal evolution</p></li>
<li><p>Accumulated uncertainty over time periods</p></li>
</ul><p>The ensemble of trajectories provides prediction intervals that widen over
time, reflecting increasing uncertainty in longer-term forecasts.</p>
<p><strong>Special Considerations:</strong></p><ol><li><p><strong>Temporal Correlation:</strong> Higher \(\rho\) values create smoother
trajectories with more persistence</p></li>
<li><p><strong>Stationarity:</strong> The AR(1) innovation variance is scaled to maintain
stationary marginal distributions</p></li>
<li><p><strong>Missing Time Points:</strong> If simulating beyond observed data (n_time &gt; T_observed),
covariates are recycled or set to zero with appropriate warnings</p></li>
</ol><p><strong>Limitations:</strong></p>
<p>As with simulate.ame, multiplicative effects currently use posterior means.
Full uncertainty would require storing complete MCMC chains for
\(u_{i,t}, v_{j,t}\) at all time points, which is memory-intensive for
large networks and long time series.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Shahryar Minhas</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Fit a longitudinal model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">YX_bin_list</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="lame.html">lame</a></span><span class="op">(</span><span class="va">YX_bin_list</span><span class="op">$</span><span class="va">Y</span>, <span class="va">YX_bin_list</span><span class="op">$</span><span class="va">X</span>, burn<span class="op">=</span><span class="fl">100</span>, nscan<span class="op">=</span><span class="fl">500</span>, family<span class="op">=</span><span class="st">"binary"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate 50 network trajectories from posterior</span></span></span>
<span class="r-in"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">fit</span>, nsim<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate longer time series</span></span></span>
<span class="r-in"><span><span class="va">sims_long</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">fit</span>, nsim<span class="op">=</span><span class="fl">25</span>, n_time<span class="op">=</span><span class="fl">20</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With new covariates</span></span></span>
<span class="r-in"><span><span class="va">new_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">YX_bin_list</span><span class="op">$</span><span class="va">X</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>, dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sims_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">fit</span>, nsim<span class="op">=</span><span class="fl">50</span>, newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Xdyad<span class="op">=</span><span class="va">new_X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shahryar Minhas, Tosin Salau, Cassy Dorff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

