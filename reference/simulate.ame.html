<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate networks from a fitted AME model — simulate.ame • lame</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate networks from a fitted AME model — simulate.ame"><meta name="description" content="Generates multiple network realizations from the posterior distribution of
a fitted AME model. This function performs posterior predictive simulation
by drawing from the full joint posterior distribution of model parameters,
thereby propagating parameter uncertainty into the simulated networks."><meta property="og:description" content="Generates multiple network realizations from the posterior distribution of
a fitted AME model. This function performs posterior predictive simulation
by drawing from the full joint posterior distribution of model parameters,
thereby propagating parameter uncertainty into the simulated networks."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lame</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.10</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html">Get Started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/netify-dev/lame" aria-label="GitHub"><span class="fa fab fa-github"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate networks from a fitted AME model</h1>
      <small class="dont-index">Source: <a href="https://github.com/netify-dev/lame/blob/main/R/simulate.ame.R" class="external-link"><code>R/simulate.ame.R</code></a></small>
      <div class="d-none name"><code>simulate.ame.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Generates multiple network realizations from the posterior distribution of
a fitted AME model. This function performs posterior predictive simulation
by drawing from the full joint posterior distribution of model parameters,
thereby propagating parameter uncertainty into the simulated networks.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'ame'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  seed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  burn_in <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  return_latent <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>fitted model object of class "ame"</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>number of networks to simulate (default: 100)</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>random seed for reproducibility</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>optional list containing new covariate data:</p><dl><dt>Xdyad</dt>
<dd><p>dyadic covariates (n x n x p array or nA x nB x p for bipartite)</p></dd>

<dt>Xrow</dt>
<dd><p>row/sender covariates (n x p matrix or nA x p for bipartite)</p></dd>

<dt>Xcol</dt>
<dd><p>column/receiver covariates (n x p matrix or nB x p for bipartite)</p></dd>


</dl><p>If NULL, uses covariates from original model fit</p></dd>


<dt id="arg-burn-in">burn_in<a class="anchor" aria-label="anchor" href="#arg-burn-in"></a></dt>
<dd><p>number of initial MCMC samples to discard (default: 0, assumes
burn-in already removed)</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>thinning interval for MCMC samples (default: 1, use every sample)</p></dd>


<dt id="arg-return-latent">return_latent<a class="anchor" aria-label="anchor" href="#arg-return-latent"></a></dt>
<dd><p>logical: return latent Z matrices in addition to Y? (default: FALSE)</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>additional arguments (not currently used)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list with components:</p><dl><dt>Y</dt>
<dd><p>list of nsim simulated networks in the same format as the original data</p></dd>

<dt>Z</dt>
<dd><p>if return_latent=TRUE, list of nsim latent Z matrices</p></dd>

<dt>family</dt>
<dd><p>the family of the model (binary, normal, etc.)</p></dd>

<dt>mode</dt>
<dd><p>network mode (unipartite or bipartite)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Mathematical Framework:</strong></p>
<p>The AME model represents networks through a latent variable framework:
$$Y_{ij} \sim F(Z_{ij})$$
where F is the observation model (e.g., probit for binary) and Z is the latent network:
$$Z_{ij} = \beta^T x_{ij} + a_i + b_j + u_i^T v_j + \epsilon_{ij}$$</p>
<p>Components:</p><ul><li><p>\(\beta\): regression coefficients for dyadic/nodal covariates</p></li>
<li><p>\(a_i, b_j\): additive sender and receiver random effects</p></li>
<li><p>\(u_i, v_j\): multiplicative latent factors (dimension R)</p></li>
<li><p>\(\epsilon_{ij}\): dyadic random effects with correlation \(\rho\)</p></li>
</ul><p><strong>Uncertainty Quantification Process:</strong></p>
<p>For each simulated network k = 1, ..., nsim:</p><ol><li><p><strong>Parameter Sampling:</strong> Draw parameter set \(\theta^{(k)}\) from MCMC chains:</p><ul><li><p>Sample iteration s uniformly from stored MCMC samples</p></li>
<li><p>Extract \(\beta^{(s)}\), variance components \((v_a^{(s)}, v_b^{(s)}, v_e^{(s)}, \rho^{(s)})\)</p></li>
</ul></li>
<li><p><strong>Random Effects Generation:</strong> Sample new random effects from posterior distributions:</p><ul><li><p>\(a_i^{(k)} \sim N(0, v_a^{(s)})\) for i = 1, ..., n (row effects)</p></li>
<li><p>\(b_j^{(k)} \sim N(0, v_b^{(s)})\) for j = 1, ..., m (column effects)</p></li>
<li><p>Note: We sample fresh from the posterior variance rather than using
point estimates to properly propagate uncertainty</p></li>
</ul></li>
<li><p><strong>Latent Network Construction:</strong> Build expected latent positions:
$$E[Z_{ij}^{(k)}] = \beta^{(s)T} x_{ij} + a_i^{(k)} + b_j^{(k)} + \hat{u}_i^T \hat{v}_j$$
where \(\hat{u}_i, \hat{v}_j\) are posterior mean latent factors</p></li>
<li><p><strong>Dyadic Correlation:</strong> Add correlated noise structure:
$$Z_{ij}^{(k)} = E[Z_{ij}^{(k)}] + \epsilon_{ij}^{(k)}$$
where \(\epsilon\) has covariance structure:
$$Cov(\epsilon_{ij}, \epsilon_{ji}) = \rho^{(s)} v_e^{(s)}$$
$$Var(\epsilon_{ij}) = v_e^{(s)}$$</p></li>
<li><p><strong>Observation Model:</strong> Generate observed network based on family:</p><ul><li><p>Binary: \(Y_{ij}^{(k)} = I(Z_{ij}^{(k)} &gt; 0)\)</p></li>
<li><p>Normal: \(Y_{ij}^{(k)} = Z_{ij}^{(k)}\)</p></li>
<li><p>Poisson: \(Y_{ij}^{(k)} \sim Poisson(\exp(Z_{ij}^{(k)}))\)</p></li>
<li><p>Other families use appropriate link functions</p></li>
</ul></li>
</ol><p><strong>Sources of Uncertainty:</strong></p>
<p>The simulation captures three types of uncertainty:</p><ol><li><p><strong>Parameter uncertainty:</strong> Different MCMC samples yield different \(\beta, v_a, v_b, v_e, \rho\)</p></li>
<li><p><strong>Random effect uncertainty:</strong> Fresh draws from \(N(0, v_a), N(0, v_b)\) for each simulation</p></li>
<li><p><strong>Dyadic uncertainty:</strong> Correlated random noise \(\epsilon_{ij}\)</p></li>
</ol><p>This approach provides proper posterior predictive distributions that account
for all sources of uncertainty in the model. The variation across simulated
networks reflects our posterior uncertainty about the data generating process.</p>
<p><strong>Limitations:</strong></p>
<p>Currently, multiplicative effects (U, V) use posterior means rather than
sampling from their full posterior. For complete uncertainty quantification,
one would need to store and sample from the full MCMC chains of these
latent factors, which would require substantial additional memory.</p>
<p><strong>Symmetric Networks:</strong></p>
<p>For symmetric networks, the model enforces \(a_i = b_i\) and \(u_i = v_i\),
and the latent matrix Z is symmetrized before generating observations.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Shahryar Minhas</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Fit a model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">YX_bin</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="ame.html">ame</a></span><span class="op">(</span><span class="va">YX_bin</span><span class="op">$</span><span class="va">Y</span>, <span class="va">YX_bin</span><span class="op">$</span><span class="va">X</span>, burn<span class="op">=</span><span class="fl">100</span>, nscan<span class="op">=</span><span class="fl">500</span>, family<span class="op">=</span><span class="st">"binary"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate 50 networks from posterior</span></span></span>
<span class="r-in"><span><span class="va">sims</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">fit</span>, nsim<span class="op">=</span><span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With new covariates</span></span></span>
<span class="r-in"><span><span class="va">new_X</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/array.html" class="external-link">array</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">YX_bin</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">YX_bin</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">YX_bin</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>               dim<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">YX_bin</span><span class="op">$</span><span class="va">X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sims_new</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/simulate.html" class="external-link">simulate</a></span><span class="op">(</span><span class="va">fit</span>, nsim<span class="op">=</span><span class="fl">50</span>, newdata<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Xdyad<span class="op">=</span><span class="va">new_X</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Shahryar Minhas, Tosin Salau, Cassy Dorff.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

